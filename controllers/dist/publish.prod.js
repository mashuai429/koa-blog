"use strict";var mysql=require("../mysql/mysql"),fs=require("fs"),publish=function(t){var a,r,n,s,c,o,i,l;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.request.body,r=mysql.timestamp(),n=new Buffer(a.image,"base64"),s=["a","b","c","d","e","f","g","h","i","g","k","l","m","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g"],c="",o=0;o<20;o++)i=Math.floor(20*Math.random()),c+=s[i];return console.log(c),fs.writeFile("public/erha/".concat(c,".png"),n,function(e,t){e&&console.log(e)}),l="INSERT INTO article (title,content,createTime,see,author,image) \n    VALUES ('".concat(a.title,"','").concat(a.content,"','").concat(r,"','1','二哈','public/erha/").concat(c,".png')"),e.next=11,regeneratorRuntime.awrap(mysql.publishApi(l));case 11:t.body={status:1e3,message:"发布成功",data:{}};case 12:case"end":return e.stop()}})};module.exports={publish:publish};